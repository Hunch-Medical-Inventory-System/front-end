import{a as b,s as _}from"./VTextField-B17VRCmP.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as C}from"./VAlert-DLmcir63.js";import{r as M}from"./VDataTable-TzwG-B0i.js";import{V as P}from"./VContainer-B9XEE_Yy.js";import{r,R as N,P as E,o as g,l as x,n as d,x as a,y as S,I as l,J as T,i as h,Q as U}from"./index-DQc5ljF0.js";import"./VIcon-C7gsGOIY.js";import"./VImg-3QOI_Jq2.js";import"./VAvatar-_qZacELr.js";import"./VSelect-DfumhngB.js";const $={colspan:"9"},A={__name:"profile",setup(B){const u=r(10),k=r([{title:"ID",key:"id",align:"center",divider:!0},{title:"Supply Name",key:"supply_name",align:"center",divider:!0},{title:"Member ID",key:"crew_members",align:"center",divider:!0},{title:"Dosage",key:"dosage",align:"center",divider:!0},{title:"Quantity",key:"quantity",align:"center",divider:!0},{title:"Units per Package",key:"units_per_package",align:"center",divider:!0},{title:"Expiry Date",key:"exp_date",align:"center",divider:!0},{title:"Created At",key:"created_at",align:"center",divider:!0},{title:"Crew Member Name",key:"crew_member_name",align:"center",divider:!0},{title:"Location",key:"location",align:"center",divider:!0}]),s=r([]),c=r(!0),p=r(0),i=r(""),m=r("");r(!1),r(null);const w=r([]);r(""),r("");const y=n=>{m.value=n},D=async()=>{const{data:n,error:t}=await _.from("inventory").select("supply_name");t?console.error("Error fetching meds:",t):w.value=n.map(e=>e.supply_name)},V=n=>{const t=new Date,f=new Date(n)-t,o=Math.ceil(f/(1e3*60*60*24));return o<=0?"expired":o<=7?"about-to-expire":o<=30?"expiring-soon":""},v=async({page:n,itemsPerPage:t})=>{c.value=!0;const{data:e,count:f,error:o}=await _.from("inventory").select("*",{count:"exact"}).ilike("supply_name",`%${i.value}%`).range((n-1)*t,n*t-1);o?(console.error("Error fetching data:",o),s.value=[],p.value=0):(s.value=e||[],p.value=f||0),c.value=!1};return N(s,n=>{n.forEach(t=>{const e=Math.ceil((new Date(t.exp_date)-new Date)/864e5);e<=0?y(`Item ${t.supply_name} has expired!`):e<=7&&y(`Item ${t.supply_name} is about to expire in ${e} days!`)})}),E(()=>{v({page:1,itemsPerPage:u.value}),D()}),(n,t)=>(g(),x(P,{rounded:"10px",class:"profile-container"},{default:d(()=>[t[2]||(t[2]=a("h1",null,"Inventory Profile",-1)),m.value?(g(),x(C,{key:0,type:"warning",border:"top",prominent:"",class:"mb-4 v_alert alert-pop-in"},{default:d(()=>[S(l(m.value),1)]),_:1})):T("",!0),h(M,{"items-per-page":u.value,"onUpdate:itemsPerPage":t[1]||(t[1]=e=>u.value=e),headers:k.value,items:s.value,"items-length":p.value,loading:c.value,search:i.value,"item-value":"id","onUpdate:options":v},{item:d(({item:e})=>[a("tr",{class:U(V(e.exp_date))},[a("td",null,l(e.id),1),a("td",null,l(e.supply_name),1),a("td",null,l(e.crew_members),1),a("td",null,l(e.dosage_taken),1),a("td",null,l(e.quantity),1),a("td",null,l(e.units_per_package),1),a("td",null,l(new Date(e.exp_date).toLocaleDateString()),1),a("td",null,l(new Date(e.created_at).toLocaleDateString()),1),a("td",null,l(e.crew_member_name),1),a("td",null,l(e.location),1)],2)]),tfoot:d(()=>[a("tr",null,[a("td",$,[h(b,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),class:"ma-2",density:"compact",placeholder:"Search inventory...","hide-details":""},null,8,["modelValue"])])])]),_:1},8,["items-per-page","headers","items","items-length","loading","search"])]),_:1}))}},H=I(A,[["__scopeId","data-v-fc6f6a74"]]);export{H as default};
