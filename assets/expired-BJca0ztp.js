import{V as oe,s as re}from"./VTextField-B17VRCmP.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{p as le,g as ne,L as de,e as D,t as c,M as ie,N as ue,h as ce,i as n,F as k,O as P,r as E,P as pe,o as C,l as me,n as N,x as s,I as d,Q as ge,q as ve,J as fe}from"./index-DQc5ljF0.js";import{m as ye,a as be,b as De,c as Pe,d as he,e as xe,f as Se,u as Te,p as we,g as _e,h as Ve,i as Be,j as Ie,k as ke,l as Ee,V as F,n as R,o as G,q as L}from"./VDataTable-TzwG-B0i.js";import{V as Ce}from"./VContainer-B9XEE_Yy.js";import"./VIcon-C7gsGOIY.js";import"./VImg-3QOI_Jq2.js";import"./VSelect-DfumhngB.js";import"./VAvatar-_qZacELr.js";const Ne=le({itemsLength:{type:[Number,String],required:!0},...ye(),...be(),...De()},"VDataTableServer"),Fe=ne()({name:"VDataTableServer",props:Ne(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,v){let{attrs:y,slots:a}=v;const{groupBy:p}=Pe(e),{sortBy:i,multiSort:o,mustSort:r}=he(e),{page:t,itemsPerPage:u}=xe(e),{disableSort:m}=de(e),H=D(()=>parseInt(e.itemsLength,10)),{columns:h,headers:q}=Se(e,{groupBy:p,showSelect:c(e,"showSelect"),showExpand:c(e,"showExpand")}),{items:f}=Te(e,h),{toggleSort:x}=we({sortBy:i,multiSort:o,mustSort:r,page:t}),{opened:A,isGroupOpen:M,toggleGroup:O,extractRows:j}=_e({groupBy:p,sortBy:i,disableSort:m}),{pageCount:z,setItemsPerPage:J}=Ve({page:t,itemsPerPage:u,itemsLength:H}),{flatItems:S}=Be(f,p,A),{isSelected:Q,select:U,selectAll:W,toggleSelect:K,someSelected:X,allSelected:Y}=Ie(e,{allItems:f,currentPage:f}),{isExpanded:Z,toggleExpand:$}=ke(e),T=D(()=>j(f.value));Ee({page:t,itemsPerPage:u,sortBy:i,groupBy:p,search:c(e,"search")}),ie("v-data-table",{toggleSort:x,sortBy:i}),ue({VDataTableRows:{hideNoData:c(e,"hideNoData"),noDataText:c(e,"noDataText"),loading:c(e,"loading"),loadingText:c(e,"loadingText")}});const l=D(()=>({page:t.value,itemsPerPage:u.value,sortBy:i.value,pageCount:z.value,toggleSort:x,setItemsPerPage:J,someSelected:X.value,allSelected:Y.value,isSelected:Q,select:U,selectAll:W,toggleSelect:K,isExpanded:Z,toggleExpand:$,isGroupOpen:M,toggleGroup:O,items:T.value.map(b=>b.raw),internalItems:T.value,groupedItems:S.value,columns:h.value,headers:q.value}));ce(()=>{const b=F.filterProps(e),ee=R.filterProps(e),ae=G.filterProps(e),te=L.filterProps(e);return n(L,P({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},te),{top:()=>{var g;return(g=a.top)==null?void 0:g.call(a,l.value)},default:()=>{var g,w,_,V,B,I;return a.default?a.default(l.value):n(k,null,[(g=a.colgroup)==null?void 0:g.call(a,l.value),!e.hideDefaultHeader&&n("thead",{key:"thead",class:"v-data-table__thead",role:"rowgroup"},[n(R,P(ee,{sticky:e.fixedHeader}),a)]),(w=a.thead)==null?void 0:w.call(a,l.value),!e.hideDefaultBody&&n("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[(_=a["body.prepend"])==null?void 0:_.call(a,l.value),a.body?a.body(l.value):n(G,P(y,ae,{items:S.value}),a),(V=a["body.append"])==null?void 0:V.call(a,l.value)]),(B=a.tbody)==null?void 0:B.call(a,l.value),(I=a.tfoot)==null?void 0:I.call(a,l.value)])},bottom:()=>a.bottom?a.bottom(l.value):!e.hideDefaultFooter&&n(k,null,[n(oe,null,null),n(F,b,{prepend:a["footer.prepend"]})])})})}}),Re={key:0},Ge={__name:"expired",setup(e){const v=E([]);async function y(){const{data:o}=await re.from("Inventory").select();v.value=o}const a=E([]);function p(){const o=new Date;a.value=v.value.filter(r=>{const u=new Date(r.exp_date)-o;return Math.ceil(u/(1e3*60*60*24))<=7})}pe(()=>{y().then(()=>{p()})});const i=o=>{const r=new Date,u=new Date(o)-r,m=Math.ceil(u/(1e3*60*60*24));return m<=0?"expired":m<=7?"about-to-expire":""};return(o,r)=>(C(),me(Ce,{rounded:"10px",class:"expired-container"},{default:N(()=>[r[2]||(r[2]=s("h1",null,"Epiry Alert",-1)),n(Fe,{"items-per-page":o.itemsPerPage,"onUpdate:itemsPerPage":r[0]||(r[0]=t=>o.itemsPerPage=t),headers:o.headers,items:a.value,"items-length":a.value.length,loading:o.loading},{item:N(({item:t})=>[s("tr",{class:ge(i(t.exp_date))},[s("td",null,d(t.id),1),s("td",null,d(t.supply_name),1),s("td",null,d(t.crew_members),1),s("td",null,d(t.dosage),1),s("td",null,d(t.quantity),1),s("td",null,d(t.units_per_package),1),s("td",null,d(new Date(t.exp_date).toLocaleDateString()),1),s("td",null,d(new Date(t.created_at).toLocaleDateString()),1),s("td",null,d(t.crew_member_name),1)],2)]),_:1},8,["items-per-page","headers","items","items-length","loading"]),a.value.length?fe("",!0):(C(),ve("div",Re,r[1]||(r[1]=[s("p",null,"No expired or about-to-expire medications found.",-1)])))]),_:1}))}},Qe=se(Ge,[["__scopeId","data-v-e8aacc46"]]);export{Qe as default};
